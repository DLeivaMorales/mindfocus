import{a as u}from"./chunk-AQA3PCK4.js";import{c as S,d as D}from"./chunk-26DWTNIE.js";var m=(()=>{let i=class i{constructor(t){this.storage=t}getTodayStats(){let t=this.storage.getSessions(),o=new Date().toDateString(),a=t.filter(e=>new Date(e.date).toDateString()===o&&e.completed),s=a.filter(e=>e.type==="enfoque"),r=a.filter(e=>e.type==="descanso"),g=a.reduce((e,c)=>e+c.duration,0);return{date:o,totalMinutes:g,sessions:a.length,focusSessions:s.length,breakSessions:r.length}}getWeeklyStats(){let t=this.storage.getSessions(),o=new Date,a=new Date(o.getTime()-10080*60*1e3),s=t.filter(n=>{let d=new Date(n.date);return d>=a&&d<=o&&n.completed}),r={L:0,M:0,X:0,J:0,V:0,S:0,D:0},g=["D","L","M","X","J","V","S"];s.forEach(n=>{let d=new Date(n.date).getDay(),f=g[d];r[f]+=n.duration}),Object.keys(r).forEach(n=>{r[n]=Math.round(r[n]/60*100)/100});let e=s.reduce((n,d)=>n+d.duration,0),c=this.calculateStreak(t);return{days:r,totalMinutes:e,totalSessions:s.length,currentStreak:c}}calculateStreak(t){if(t.length===0)return 0;let o=[...t].filter(e=>e.completed).sort((e,c)=>new Date(c.date).getTime()-new Date(e.date).getTime());if(o.length===0)return 0;let a=0,s=new Date;s.setHours(0,0,0,0);let r=s.toDateString();if(!o.some(e=>new Date(e.date).toDateString()===r)){s.setDate(s.getDate()-1);let e=s.toDateString();if(!o.some(n=>new Date(n.date).toDateString()===e))return 0}for(;;){let e=s.toDateString();if(o.some(n=>new Date(n.date).toDateString()===e))a++,s.setDate(s.getDate()-1);else break}return a}getHistorySessions(t=10){return this.storage.getSessions().filter(a=>a.completed).sort((a,s)=>new Date(s.date).getTime()-new Date(a.date).getTime()).slice(0,t)}getAllSessions(){return this.storage.getSessions().filter(t=>t.completed).sort((t,o)=>new Date(o.date).getTime()-new Date(t.date).getTime())}};i.\u0275fac=function(o){return new(o||i)(D(u))},i.\u0275prov=S({token:i,factory:i.\u0275fac,providedIn:"root"});let l=i;return l})();export{m as a};
