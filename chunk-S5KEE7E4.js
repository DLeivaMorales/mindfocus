import{a as G}from"./chunk-AR7TQDRQ.js";import"./chunk-AQA3PCK4.js";import{a as A,c as j,d as K,p as V}from"./chunk-YTHTS2EK.js";import{$ as F,A as h,B as _,C as v,D as C,E as b,G as M,H as O,I as P,P as I,Q as D,R as w,V as E,aa as T,ba as k,ca as z,da as N,ea as q,ha as B,ia as H,k as a,l as y,la as L,m as x,n as p,na as W,p as m,q as i,r as s,s as f,u as S,v as u,z as d}from"./chunk-26DWTNIE.js";import"./chunk-ABKQFRDF.js";import"./chunk-JSQBYJDC.js";import"./chunk-RRJEHXKK.js";import"./chunk-GZDTMPMM.js";import"./chunk-JVTPOORY.js";import"./chunk-CLDSZD2A.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-YAUMUHNT.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import"./chunk-JHI3MBHO.js";function J(r,l){r&1&&(i(0,"div",11),f(1,"ion-icon",12),i(2,"h2"),d(3,"No hay sesiones registradas"),s(),i(4,"p"),d(5,"Completa tu primera sesi\xF3n de enfoque para verla aqu\xED"),s()())}function Q(r,l){if(r&1&&(i(0,"ion-item",19),f(1,"ion-icon",20),i(2,"ion-label")(3,"h3"),d(4),s(),i(5,"p"),d(6),s()(),i(7,"ion-badge",21),d(8),s()()),r&2){let c=l.$implicit,e=u(3);a(),m("name",e.getSessionIcon(c.type))("color",e.getSessionColor(c.type)),a(3),h(c.startTime),a(2),_("",c.duration," min"),a(),m("color",e.getSessionColor(c.type)),a(),_(" ",c.type==="enfoque"?"Enfoque":"Descanso"," ")}}function R(r,l){if(r&1&&(i(0,"div",15)(1,"div",16),f(2,"ion-icon",12),i(3,"span"),d(4),s()(),i(5,"ion-list",17),p(6,Q,9,6,"ion-item",18),s()()),r&2){let c=l.$implicit,e=u(2);a(4),h(e.formatDate(c.sessions[0]==null?null:c.sessions[0].date)),a(2),m("ngForOf",c.sessions)}}function U(r,l){if(r&1&&(i(0,"div",13),p(1,R,7,2,"div",14),s()),r&2){let c=u();a(),m("ngForOf",c.groupSessionsByDate())}}var ae=(()=>{let l=class l{constructor(e){this.statisticsService=e,this.sessions=[],this.filteredSessions=[],this.selectedFilter="all",A({time:V,cafe:j,calendar:K})}ngOnInit(){this.loadSessions()}ionViewWillEnter(){this.loadSessions()}loadSessions(){try{this.sessions=this.statisticsService.getAllSessions(),this.applyFilter()}catch(e){console.error("Error loading sessions:",e),this.sessions=[],this.filteredSessions=[]}}onFilterChange(e){this.selectedFilter=e.detail.value,this.applyFilter()}applyFilter(){try{let e=new Date,t=e.toDateString();switch(this.selectedFilter){case"today":this.filteredSessions=this.sessions.filter(n=>{try{return n&&n.date&&new Date(n.date).toDateString()===t}catch{return!1}});break;case"week":let o=new Date(e.getTime()-10080*60*1e3);this.filteredSessions=this.sessions.filter(n=>{try{return n&&n.date&&new Date(n.date)>=o}catch{return!1}});break;default:this.filteredSessions=this.sessions.filter(n=>n&&n.date)}}catch(e){console.error("Error applying filter:",e),this.filteredSessions=[]}}formatDate(e){try{if(!e)return"Fecha desconocida";let t=new Date(e);if(isNaN(t.getTime()))return"Fecha inv\xE1lida";let o=new Date().toDateString(),n=new Date(Date.now()-864e5).toDateString();return t.toDateString()===o?"Hoy":t.toDateString()===n?"Ayer":t.toLocaleDateString("es-ES",{day:"numeric",month:"short"})}catch(t){return console.error("Error formatting date:",t),"Fecha inv\xE1lida"}}getSessionIcon(e){return e==="enfoque"?"time":"cafe"}getSessionColor(e){return e==="enfoque"?"success":"secondary"}groupSessionsByDate(){try{let e={};return this.filteredSessions.forEach(t=>{try{if(!t||!t.date)return;let o=new Date(t.date);if(isNaN(o.getTime()))return;let n=o.toDateString();e[n]||(e[n]=[]),e[n].push(t)}catch(o){console.error("Error processing session:",o,t)}}),Object.keys(e).sort((t,o)=>new Date(o).getTime()-new Date(t).getTime()).map(t=>({date:t,sessions:e[t]}))}catch(e){return console.error("Error grouping sessions:",e),[]}}};l.\u0275fac=function(t){return new(t||l)(y(G))},l.\u0275cmp=x({type:l,selectors:[["app-tab3"]],decls:20,vars:5,consts:[[3,"translucent"],["color","primary"],[1,"ion-text-center"],[3,"ngModelChange","ionChange","ngModel"],["value","all"],["value","today"],["value","week"],[3,"fullscreen"],[1,"history-container"],["class","empty-state",4,"ngIf"],["class","sessions-list",4,"ngIf"],[1,"empty-state"],["name","calendar"],[1,"sessions-list"],["class","date-group",4,"ngFor","ngForOf"],[1,"date-group"],[1,"date-header"],[1,"session-items"],["class","session-item",4,"ngFor","ngForOf"],[1,"session-item"],["slot","start",1,"session-icon",3,"name","color"],["slot","end",3,"color"]],template:function(t,o){t&1&&(i(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-title",2)(3,"strong"),d(4,"Historial"),s()()(),i(5,"ion-toolbar")(6,"ion-segment",3),b("ngModelChange",function(g){return C(o.selectedFilter,g)||(o.selectedFilter=g),g}),S("ionChange",function(g){return o.onFilterChange(g)}),i(7,"ion-segment-button",4)(8,"ion-label"),d(9,"Todo"),s()(),i(10,"ion-segment-button",5)(11,"ion-label"),d(12,"Hoy"),s()(),i(13,"ion-segment-button",6)(14,"ion-label"),d(15,"Esta semana"),s()()()()(),i(16,"ion-content",7)(17,"div",8),p(18,J,6,0,"div",9)(19,U,2,1,"div",10),s()()),t&2&&(m("translucent",!0),a(6),v("ngModel",o.selectedFilter),a(10),m("fullscreen",!0),a(2),m("ngIf",o.filteredSessions.length===0),a(),m("ngIf",o.filteredSessions.length>0))},dependencies:[P,M,O,w,I,D,T,H,B,F,N,k,z,E,L,W,q],styles:[".history-container[_ngcontent-%COMP%]{max-width:600px;margin:0 auto;padding:16px}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;color:var(--ion-color-medium)}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:80px;opacity:.5;margin-bottom:20px}.empty-state[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.3rem;margin-bottom:10px;color:var(--ion-color-dark)}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.95rem}.sessions-list[_ngcontent-%COMP%]{padding-bottom:20px}.date-group[_ngcontent-%COMP%]{margin-bottom:24px}.date-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 16px;background-color:var(--ion-color-light);border-radius:8px;margin-bottom:8px;font-weight:600;color:var(--ion-color-dark);font-size:.9rem}.date-header[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.2rem;color:var(--ion-color-primary)}.session-items[_ngcontent-%COMP%]{background:transparent}.session-items[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: white;--border-radius: 8px;--padding-start: 16px;--padding-end: 16px;--inner-padding-end: 0;margin-bottom:8px;border-radius:8px;box-shadow:0 2px 8px #00000014}.session-items[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]::part(native){border-radius:8px}.session-icon[_ngcontent-%COMP%]{font-size:1.8rem;margin-right:12px}ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:var(--ion-color-dark);margin-bottom:4px}ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.9rem;color:var(--ion-color-medium)}ion-badge[_ngcontent-%COMP%]{font-size:.75rem;padding:6px 12px;border-radius:12px;font-weight:600}ion-segment[_ngcontent-%COMP%]{padding:8px}ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]{--indicator-color: var(--ion-color-primary);font-size:.9rem;min-height:36px}"]});let r=l;return r})();export{ae as Tab3Page};
